# 手動テスト

## 結合テスト

### 1. 認証フロー

前提条件: ログアウトし、アプリをアンインストールしてから、再インストールする。

- **ログイン画面**
  - 利用規約とプライバシーポリシー
    - 「利用規約」をタップすると、利用規約が閲覧できること。
      - [x] iOS
      - [ ] Android
    - 「プライバシーポリシー」をタップすると、プライバシーポリシーが閲覧できること。
      - [x] iOS
      - [ ] Android
  - **Google ログイン機能**
    - [ ] **正常系**: 「Google で続ける」ボタンをタップすると、Google アカウントの選択画面が表示され、認証に成功するとホーム画面に遷移すること。
    - [ ] **異常系**: Google アカウントの選択画面でキャンセルした場合、ログイン画面に留まり、操作が継続できること。
    - [ ] **異常系**: ネットワークエラーなどで認証に失敗した場合、「ログインに失敗しました」という旨のスナックバーが表示され、ログイン画面に留まること。
  - **Apple ログイン機能 (iOS のみ)**
    - [ ] **正常系**: 「Apple で続ける」ボタンをタップすると、Apple ID の認証画面が表示され、認証に成功するとホーム画面に遷移すること。
    - [ ] **異常系**: Apple ID の認証画面でキャンセルした場合、ログイン画面に留まり、操作が継続できること。
    - [ ] **異常系**: 認証に失敗した場合、「ログインに失敗しました」という旨のスナックバーが表示され、ログイン画面に留まること。
  - **匿名ログイン機能**
    - [ ] **正常系**: 「アカウントを利用せず続ける」ボタンをタップすると、匿名ユーザーとしてログインし、ホーム画面に遷移すること。
    - [ ] **異常系**: 匿名認証に失敗した場合、エラーメッセージがスナックバーで表示され、ログイン画面に留まること。
- **アカウント連携**
  - [ ] 匿名ユーザーが設定画面から Google アカウントと連携できる。
  - [ ] 匿名ユーザーが設定画面から Apple アカウントと連携できる (iOS のみ)。
  - [ ] 連携後、ユーザー情報が正しく更新される（アイコン、表示名など）。
  - [ ] 連携済みの Google/Apple アカウントで連携しようとした場合、専用のエラーメッセージが表示される。
- **ログアウト・アカウント削除**
  - [ ] 設定画面からログアウトできる。
  - [ ] ログアウト後、ログイン画面に遷移する。
  - [ ] 設定画面からアカウントを削除できる。
  - [ ] アカウント削除後、ログイン画面に遷移する。
  - [ ] 削除したアカウントは Firebase Auth の管理画面から削除されている。

### 2. ホーム画面

- **家事一覧タブ**
  - [ ] 家事が一件も登録されていない場合、「登録されている家事はありません」というメッセージが表示される。
  - [ ] 登録済みの家事が作成した順で表示される。
- **ログ一覧タブ**
  - [ ] ログがない場合に空の状態が表示される。
  - [ ] 完了した家事ログが、完了日時の降順で一覧表示される。

### 3. 家事

### 3-1. 家事追加・編集

- **家事追加**
  - [ ] フローティングアクションボタンから家事追加画面に遷移できる。
  - [ ] 家事の名前とアイコンを入力して、新しい家事を登録できる。
  - [ ] 登録後、ホーム画面の家事一覧に新しい家事が追加されている。
- **Pro 版制限**
  - [ ] フリー版ユーザーが家事を 10 件登録済みの状態で、11 件目を登録しようとすると、Pro 版へのアップグレードを促すダイアログが表示され、登録ができない。
  - [ ] Pro 版ユーザーは、11 件以上の家事を登録できる。

### 3-2. 家事ログ追加

- [ ] 家事アイテムをタップすると、現在時刻で家事ログが記録される。
- [ ] クイック登録バーから家事をタップすると、現在時刻で完了ログが記録される。
- [ ] 家事ログの右側のコピーボタンをタップすると、現在時刻で家事ログが記録される。

### 3-3. 家事ログ削除

- [ ] 家事ログをスワイプすると、削除ボタンが表示される。

### 3-4. 家事削除

- [ ] 家事アイテムをロングタップすると、コンテキストメニューが表示される。
- [ ] 削除ダイアログで「削除」をタップすると、家事が削除され、「家事を削除しました」というスナックバーが表示される。

### 4. 分析画面

- [ ] 分析モード（頻度・曜日・時間帯）を切り替えられる。
- [ ] 各モードでグラフと凡例が正しく描画される。
- [ ] 凡例をタップすると、該当項目の表示/非表示が切り替わり、グラフが更新される。
- [ ] 凡例をロングタップすると、該当項目のみが表示され、グラフが更新される。
- [ ] 単一表示状態で再度同じ凡例をロングタップすると、全項目表示に戻る。

### 5. 設定・課金

- **設定画面**
  - [ ] ログインしているアカウントの種類（Google/Apple/匿名）に応じたユーザー情報（アイコン、表示名）が表示される。
  - [ ] フリー版ユーザーの場合、「現在のプラン: フリー版」と表示され、「プロ版にアップグレード」ボタンが表示される。
  - [ ] Pro 版ユーザーの場合、「現在のプラン: Pro 版」と表示され、「プロ版にアップグレード」ボタンが非表示になる。
  - [ ] 「プロ版にアップグレード」ボタンをタップすると、アップグレード画面に遷移する。
- **Pro 版アップグレード画面**
  - [ ] RevenueCat から取得した商品情報（価格など）が動的に表示される。
  - [ ] 情報取得中にローディングスケルトンが表示される。
  - [ ] 購入処理が成功すると設定画面に戻り、プラン情報が「Pro 版」に更新される（要モック）。
  - [ ] 購入処理が失敗・キャンセルされた場合、エラーメッセージが表示される。
- **デバッグ**
  - [ ] 本番リリースビルドでは、デバッグ機能が表示されない

## シナリオテスト

### シナリオ 1：新規ユーザー登録から基本操作

1. アプリを初回起動し、ログイン画面が表示されることを確認する。
2. 「Google で続ける」をタップし、新規アカウントでサインアップする。
3. ホーム画面が表示され、家事一覧が空の状態であることを確認する。
4. FAB をタップし、家事追加画面で新しい家事（例：「部屋の掃除」）を登録する。
5. ホーム画面の家事一覧に「部屋の掃除」が表示されていることを確認する。
6. 「部屋の掃除」アイテムの左側をタップして完了ログを記録する。
7. 完了アニメーションとスナックバーが表示され、「ログ」タブがハイライトされることを確認する。
8. 「ログ」タブに切り替え、完了ログが記録されていることを確認する。
9. 設定画面に遷移し、自分の Google アカウント情報と「現在のプラン: フリー版」が表示されていることを確認する。
10. ログアウトし、ログイン画面に戻ることを確認する。

### シナリオ 2：フリー版から Pro 版へのアップグレード

1. フリー版ユーザーでログインする。
2. 家事を 10 件登録する。
3. 11 件目の家事を登録しようとし、アップグレードを促すダイアログが表示されることを確認する。
4. ダイアログの「Pro 版にアップグレード」ボタンをタップし、アップグレード画面へ遷移することを確認する。
5. （または設定画面から）アップグレード画面へ遷移し、購入ボタンをタップする。
6. 購入処理を（モックで）成功させる。
7. 設定画面に戻り、「現在のプラン: Pro 版」に表示が更新されていることを確認する。
8. 再度、家事追加画面を開き、11 件目の家事が登録できることを確認する。

### シナリオ 3：匿名ユーザーのアカウント連携

1. 「アカウントを利用せず続ける」で匿名ユーザーとしてログインする。
2. 家事をいくつか登録・完了する。
3. 設定画面に遷移し、「ゲストユーザー」と表示されていること、アカウント連携の案内があることを確認する。
4. 「Apple ID と連携」をタップし、アカウント連携を完了させる。
5. 設定画面のユーザー情報が Apple アカウントのものに更新されていることを確認する。
6. アプリを再起動し、Apple アカウントで自動ログインされ、登録した家事データが保持されていることを確認する。
